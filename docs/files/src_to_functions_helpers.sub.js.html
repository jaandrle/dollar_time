<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Documentation: $time@0.4.0</title>
    <link rel="stylesheet" href="../assets/from_yahhoapis/cssgrids-min.css">
<link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="../assets/from_yahhoapis/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png" width="117" height="52">$time</a>: src\to_functions\helpers.sub.js</h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.0</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/$time.{namespace}.html">$time.{namespace}</a></li>
                    </ul>
                </div>
            </div>
            
            <div id="elements" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Elements</h2>
                </div>
                <div class="bd">
                    <ul>
                    </ul>
                </div>
            </div>
            
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>src\$time.js/<ul></ul></li><li>src\$time_init.sub.js/<ul></ul></li><li>src\from_functions\fromDate.sub.js/<ul></ul></li><li>src\from_functions\fromDateArguments.sub.js/<ul></ul></li><li>src\from_functions\fromNow.sub.js/<ul></ul></li><li>src\from_functions\fromString.sub.js/<ul></ul></li><li>src\from_functions\toDateArray.sub.js/<ul></ul></li><li>src\modify\modify.sub.js/<ul></ul></li><li>src\to_functions\helpers.sub.js/<ul></ul></li><li>src\to_functions\toDate.sub.js/<ul></ul></li><li>src\to_functions\toLocaleString.sub.js/<ul></ul></li><li>src\to_functions\toString.sub.js/<ul></ul></li><li>src\utility\double.sub.js/<ul></ul></li><li>src\utility\getDaysInMonth.sub.js/<ul></ul></li><li>src\utility\getMonthName.sub.js/<ul></ul></li><li>src\utility\getOrdinalSuffix.sub.js/<ul></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>src\to_functions\helpers.sub.js</h4>

<pre class="code prettyprint linenums">
/* jshint esversion: 6,-W097, -W040, browser: true, expr: true, undef: true */
/* init *//* global internal_locale, internal_zone, format_arrays */
/* timezones/generateTimeZoneFormatObject *//* global generateTimeZoneFormatObject */
/* to_functions *//* global toDate */
/* modify/Date *//* global getWeekNumber, getWeekDay */
/* utility *//* global getOrdinalSuffix */
/**
 * Function generates text based on &#x60;format&#x60;, &#x60;locale&#x60; and &#x60;timeZone&#x60; from &#x60;DateArray&#x60;.
 * @method toStringFromObject
 * @for $time.{namespace}
 * @private
 * @param {Array} format
 *  - Placeholder for replace/generate final string (eg. [[ &quot;month&quot;, &quot;2-digits&quot; ]]===two digits month)
 *  - see [&#x60;getFormatObject&#x60;](#methods_getFormatObject) an [&#x60;format_arrays&#x60;](#props_format_arrays).
 * @param {DateArray} params_obj
 *  - It is in fact argument for [&#x60;Date.prototype.toLocaleString&#x60;](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString)
 * @param {String} params_obj.locale
 *  - In which language/national format generate final string
 * @param {String} params_obj.timeZone
 *  - Time zone name from [&#x60;ary_ianna_time_zones&#x60;](#props_ary_ianna_time_zones).
 * @param {String} params_obj.declension
 *  - **default: true**
 *  - Needed for some languages — for example in Czech: &quot;10. července&quot; (&#x60;declension=true&#x60;), or &quot;10. červenec&quot; (&#x60;declension=false&#x60;)
 * @returns {Function}
 *  - &#x60;DateArray&#x60;=&gt; **&amp;lt;String&amp;gt;**
 * @example
 *      $time.toStringFromObject(&quot;DD/MM/YYYY HH:mm:SS&quot;,{ locale: &quot;en-GB&quot; })($time.fromNow());//= &quot;05/06/2019 09:32:20&quot;
 */
function toStringFromObject(format= format_arrays.SQL, { locale= internal_locale, declension= true, timeZone= internal_zone }= {}){
    return date_array=&gt; format.map(evaluateFormatObject(toDate(date_array), locale, timeZone, declension)).join(&quot;&quot;);
}
function evaluateFormatObject(date, locale, timeZone, declension){
    const localeObj= generateTimeZoneFormatObject.bind(null, timeZone);
    return function([type, value, modify]){
        let out= evaluateNthFromObject(date, type, value, modify, declension, locale, localeObj);
        if(value===&quot;2-digit&quot;&amp;&amp;String(out).length===1) out= &quot;0&quot;+out; //fix
        if(modify===&quot;two_letters&quot;) out= out.substr(0,2);
        else if(modify===&quot;ordinal_number&quot;&amp;&amp;locale.indexOf(&quot;en&quot;)!==-1) out= getOrdinalSuffix(out);
        return out;
    };
}
function evaluateNthFromObject(date, type, value, modify, declension, locale, localeObj){
    switch (true){
        case type===&quot;text&quot;:                                     return value;
        case type===&quot;week&quot;:                                     return getWeekNumber(date);
        case type===&quot;weekday&quot;&amp;&amp;value===&quot;numeric&quot;:               return getWeekDay()(date);
        case type===&quot;month&quot;&amp;&amp;value===&quot;long&quot;&amp;&amp;declension:        return date.toLocaleString(locale,localeObj({ [type]: value, day: &quot;numeric&quot; })).replace(/[\d \.\/\\]/g, &quot;&quot;);
        case type===&quot;hour&quot;&amp;&amp;modify.toLowerCase()===&quot;a&quot;:         return date.toLocaleString(modify===&quot;A&quot; ? &quot;en-US&quot; : &quot;en-GB&quot;,localeObj({ [type]: value, hourCycle: &quot;h12&quot; })).replace(/[\d \.\/\\]/g, &quot;&quot;);
        case type===&quot;hour&quot;:                                     return date.toLocaleString(locale,localeObj({ [type]: value, hourCycle: modify })).replace(/[ \.\/\\pam]/ig, &quot;&quot;);
        default:                                                return date.toLocaleString(locale,localeObj({ [type]: value }));
    }
}
/**
 * Generates multidimensional array for formatting (eg. &quot;YYYY&quot;=&gt; &#x60;[ [ &quot;year&quot;, &quot;numeric&quot; ] ]&#x60;).
 * @method getFormatObject
 * @for $time.{namespace}
 * @private
 * @param {String} format_string
 *  - supports &quot;YYYY&quot;, &quot;YY&quot;, &quot;MM&quot;, &quot;MMM&quot;, &quot;MMMM&quot;, &quot;dddd&quot; (weekday - Monday), &quot;ddd&quot; (shorter weekday - Mon), &quot;dd&quot; (Mo), &quot;d&quot; (0===Sun &lt;&gt; 6===Sat), &quot;DD&quot;, &quot;D&quot;, &quot;Do&quot;, &quot;HH&quot;, &quot;H&quot;, &quot;mm&quot;, &quot;m&quot;, &quot;SS&quot;, &quot;S&quot;, &quot;W&quot;, &quot;Wo&quot;
 * @returns {...Array}
 *  - &#x60;[ [ operation, argument, params ] ]&#x60;
 *  - &#x60;Opertions&#x60; are in fact arguments for [&#x60;Date.prototype.toLocaleString&#x60;](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString) and &#x60;arguments&#x60; are their values.
 */
function getFormatObject(format_string= &quot;&quot;){
    let out= [], out_last_index, letter;
    while(format_string.length){
        switch(format_string[0]){
            case &quot;M&quot;: handleM();                            break;
            case &quot;d&quot;: handled();                            break;
            case &quot;W&quot;: handleWD(&quot;week&quot;, &quot;W&quot;);                break;
            case &quot;Y&quot;: handleY();                            break;
            case &quot;D&quot;: handleWD(&quot;day&quot;, &quot;D&quot;);                 break;
            case &quot;H&quot;: handleHh(&quot;hour&quot;, &quot;H&quot;, &quot;h23&quot;);         break;
            case &quot;k&quot;: handleHh(&quot;hour&quot;, &quot;k&quot;, &quot;h24&quot;);         break;
            case &quot;h&quot;: handleHh(&quot;hour&quot;, &quot;h&quot;, &quot;h12&quot;);         break;
            case &quot;A&quot;: handleAa(&quot;A&quot;);                        break;
            case &quot;a&quot;: handleAa(&quot;a&quot;);                        break;
            case &quot;m&quot;: handle(&quot;minute&quot;, &quot;m&quot;);                break;
            case &quot;s&quot;: handle(&quot;second&quot;, &quot;s&quot;);                break;
            case &quot;[&quot;: handleText();                         break;
            default:
                letter= format_string[0];
                out_last_index= out.length-1;
                if(out_last_index&gt;-1&amp;&amp;out[out_last_index][0]===&quot;text&quot;) out[out_last_index][1]+= letter;
                else out.push([&quot;text&quot;, letter]);
                format_string= format_string.substring(1);
        }
    }
    function handleM(){
        let type= &quot;numeric&quot;;
        if(!format_string.search(/MMMM/)){
            type= &quot;long&quot;;
            format_string= format_string.substring(4);
        } else if(!format_string.search(/MMM/)){
            type= &quot;short&quot;;
            format_string= format_string.substring(3);
        } else if(!format_string.search(/MM/)){
            type= &quot;2-digit&quot;;
            format_string= format_string.substring(2);
        } else if(!format_string.search(/Mo/)){
            format_string= format_string.substring(2);
            return out.push([&quot;month&quot;, type, &quot;ordinal_number&quot;]);
        } else {
            format_string= format_string.substring(1);
        }
        out.push([&quot;month&quot;, type]);
    }
    function handled(){
        let type= &quot;numeric&quot;;
        if(!format_string.search(/dddd/)){
            type= &quot;long&quot;;
            format_string= format_string.substring(4);
        } else if(!format_string.search(/ddd/)){
            type= &quot;short&quot;;
            format_string= format_string.substring(3);
        } else if(!format_string.search(/dd/)){
            type= &quot;short&quot;;
            format_string= format_string.substring(2);
            return out.push([&quot;weekday&quot;, type, &quot;two_letters&quot;]);
        } else {
            format_string= format_string.substring(1);
        }
        out.push([&quot;weekday&quot;, type]);
    }
    function handleY(){
        let type= &quot;2-digit&quot;;
        if(!format_string.search(/YYYY/)){
            type= &quot;numeric&quot;;
            format_string= format_string.substring(4);
        } else {
            format_string= format_string.substring(2);
        }
        out.push([&quot;year&quot;, type]);
    }
    function handleWD(out_key, letter){
        let type= &quot;numeric&quot;;
        if(!format_string.search(new RegExp(letter+&quot;o&quot;))){
            format_string= format_string.substring(2);
            return out.push([out_key, type, &quot;ordinal_number&quot;]);
        } else if(!format_string.search(new RegExp(letter+letter))){
            type= &quot;2-digit&quot;;
            format_string= format_string.substring(2);
        } else {
            format_string= format_string.substring(1);
        }
        out.push([out_key, type]);
    }
    function handleHh(out_key, letter, hourCycle){
        let type= &quot;numeric&quot;;
        if(!format_string.search(new RegExp(letter+letter))){
            type= &quot;2-digit&quot;;
            format_string= format_string.substring(2);
        } else {
            format_string= format_string.substring(1);
        }
        out.push([out_key, type, hourCycle]);
    }
    function handleAa(modify){
        format_string= format_string.substring(1);
        out.push([&quot;hour&quot;, &quot;numeric&quot;, modify]);
    }
    function handle(out_key, letter){
        let type= &quot;numeric&quot;;
        if(!format_string.search(new RegExp(letter+letter))){
            type= &quot;2-digit&quot;;
            format_string= format_string.substring(2);
        } else {
            format_string= format_string.substring(1);
        }
        out.push([out_key, type]);
    }
    function handleText(){
        const text_end= format_string.indexOf(&quot;]&quot;);
        if(text_end===-1){
            format_string= format_string.substring(1);
            return false;
        }
        out.push([&quot;text&quot;, format_string.substr(1,text_end-1)]);
        format_string= format_string.substr(text_end+1);
    }
    return out;
}
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>

</body>
</html>
